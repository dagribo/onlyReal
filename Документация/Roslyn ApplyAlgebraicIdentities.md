### Оптимизация алгебраических тождеств
Локальные оптимизации трехадресного кода. Оптимизация алгебраических операций, приводящих к определенному результату в не зависимости от значений переменных, участвующих в выражении.

### Команда Roslyn

#### Постановка задачи
Требуется найти в трехадресном коде выражения, результаты которых можно вычислить на этапе компиляции в не зависимости от значений переменных, участвующих в выражении, и произвести соответствующие оптимизации, заменив выражения их значениями.

#### Зависимости задач в графе задач
Задача зависит от:
* генерации трехадресного кода.

#### Теория
В исходном коде программы можно встретить выражения, результат которых можно вычислить на этапе компиляции проекта в не зависимости от конкретных значений переменных. К таким выражениям можно отнести следующие:

* *b\*0*
* *1\*b*
* *b\*1*
* *b+0*
* *0+b*
* *b-1*
* *b-b*
* *b/1*

Подобные выражения можно оптимизировать, если при компиляции исходного кода программы частично произвести вычисления данных выражений. В некоторых ситуациях можно получить конечный результат выражения, но в некоторых случаях необходимо знать значения конечных переменных. Подобная оптимизация позволит сделать вычисление программы более быстрым, поскольку потребуется меньше памяти для вычисления программы, поскольку некоторые переменные перестанут быть необходимыми, и операций работы с оперативной памятью станет меньше.

#### Особенности реализации
При использовании кода, производящего оптимизацию вычисления алгебраических выражений, следует использовать класс, реализующий каскадные оптимизации трехадресного кода программы AutoThreeCodeOptimiser. Таким образом, последовательность действий для использования данной оптимизации будет следующей:
1) сгенерировать трехадресный код;
2) создать объект *SimpleLang.ThreeCodeOptimisations.AutoThreeCodeOptimiser*;
3) добавить к созданному объекту новый объект типа *SimpleLang.ThreeCodeOptimisations.ApplyAlgebraicIdentities*;
4) вызвать метод Apply объекта AutoThreeCodeOptimiser.
```csharp
using SimpleLang.ThreeCodeOptimisations;
...
AutoThreeCodeOptimiser opt = new AutoThreeCodeOptimiser();
opt.Add(new ApplyAlgebraicIdentities());
opt.Apply(visitor);
```
В данном коде подразумевается, что переменная *visitor* является объектом класса *ThreeAddressCodeVisitor*.


#### Тесты
Для исходного кода 
```csharp
{
	int b;
	b = b * 0;
	b = 1 * b;
	b = b * 1;
	b = b + 0;
	b = 0 + b;
	b = b - 0;
	b = b - b;
	b = b / 1;
}
```
генератор трехадресного кода генерирует следующий код:
```csharp
    temp_0 = b * 0
    b = temp_0
    temp_1 = 1 * b
    b = temp_1
    temp_2 = b * 1
    b = temp_2
    temp_3 = b + 0
    b = temp_3
    temp_4 = 0 + b
    b = temp_4
    temp_5 = b - 0
    b = temp_5
    temp_6 = b - b
    b = temp_6
    temp_7 = b / 1
    b = temp_7
```
После использования оптимизации алгебраических тождеств получается следующий код:
```csharp
    temp_0 = 0
    b = temp_0
    temp_1 = b
    b = temp_1
    temp_2 = b
    b = temp_2
    temp_3 = b
    b = temp_3
    temp_4 = b
    b = temp_4
    temp_5 = b
    b = temp_5
    temp_6 = 0
    b = temp_6
    temp_7 = b
    b = temp_7
```
